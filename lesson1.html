<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lesson 1: HTML Basics & Structure</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
        }

        header {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            margin-bottom: 30px;
        }

        header h1 {
            color: #667eea;
            margin-bottom: 10px;
        }

        .lesson-number {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            display: inline-block;
            margin-bottom: 15px;
            font-weight: bold;
        }

        .content-section {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            margin-bottom: 20px;
        }

        .content-section h2 {
            color: #764ba2;
            margin-bottom: 15px;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }

        .content-section h3 {
            color: #667eea;
            margin-top: 20px;
            margin-bottom: 10px;
        }

        .info-box {
            background: #e7f3ff;
            border-left: 4px solid #2196F3;
            padding: 15px;
            margin: 20px 0;
        }

        .info-box strong {
            color: #2196F3;
        }

        .warning-box {
            background: #fff3cd;
            border-left: 4px solid #ff9800;
            padding: 15px;
            margin: 20px 0;
        }

        .warning-box strong {
            color: #ff9800;
        }

        .success-box {
            background: #d4edda;
            border-left: 4px solid #28a745;
            padding: 15px;
            margin: 20px 0;
        }

        .success-box strong {
            color: #28a745;
        }

        .code-box {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 20px;
            border-radius: 5px;
            overflow-x: auto;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            position: relative;
        }

        .code-box code {
            color: #f8f8f2;
        }

        .code-label {
            background: #667eea;
            color: white;
            padding: 5px 10px;
            border-radius: 3px;
            font-size: 0.8em;
            position: absolute;
            top: 10px;
            right: 10px;
        }

        .try-it {
            background: #f0f0f0;
            border: 2px dashed #667eea;
            padding: 20px;
            border-radius: 5px;
            margin: 20px 0;
        }

        .try-it h4 {
            color: #667eea;
            margin-bottom: 10px;
        }

        .step-number {
            background: #667eea;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
            font-weight: bold;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }

        .nav-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 12px 25px;
            text-decoration: none;
            border-radius: 5px;
            transition: opacity 0.3s ease;
        }

        .nav-button:hover {
            opacity: 0.9;
        }

        ul, ol {
            margin-left: 30px;
            margin-top: 10px;
        }

        li {
            margin-bottom: 8px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        table th, table td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }

        table th {
            background: #667eea;
            color: white;
        }

        table tr:nth-child(even) {
            background: #f9f9f9;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <span class="lesson-number">LESSON 1</span>
            <h1>HTML Basics & Structure</h1>
            <p>Learn the foundation of web pages and understand how HTML works</p>
        </header>

        <div class="content-section">
            <h2>What is HTML?</h2>
            <p><strong>HTML</strong> stands for <strong>HyperText Markup Language</strong>. It's the standard language used to create web pages. Think of HTML as the skeleton of a webpage - it provides the structure and content.</p>

            <div class="info-box">
                <strong>For Journalists:</strong> Just like you structure a news article with a headline, byline, lead paragraph, and body text, HTML helps you structure web content with tags that define headings, paragraphs, images, and more.
            </div>

            <h3>How HTML Works</h3>
            <p>HTML uses <strong>tags</strong> to mark up content. Tags are like instructions that tell the web browser how to display content. Most tags come in pairs:</p>

            <ul>
                <li>An <strong>opening tag</strong>: <code>&lt;tagname&gt;</code></li>
                <li>The <strong>content</strong> between the tags</li>
                <li>A <strong>closing tag</strong>: <code>&lt;/tagname&gt;</code></li>
            </ul>

            <div class="code-box">
                <div class="code-label">Example</div>
                <code>&lt;p&gt;This is a paragraph.&lt;/p&gt;</code>
            </div>

            <p>In this example:</p>
            <ul>
                <li><code>&lt;p&gt;</code> is the opening tag</li>
                <li>"This is a paragraph." is the content</li>
                <li><code>&lt;/p&gt;</code> is the closing tag (notice the forward slash)</li>
            </ul>
        </div>

        <div class="content-section">
            <h2>Basic HTML Structure</h2>
            <p>Every HTML page follows the same basic structure. Here's what a minimal HTML page looks like:</p>

            <div class="code-box">
                <div class="code-label">Basic HTML Template</div>
                <pre><code>&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;My First Webpage&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;Welcome to My Webpage&lt;/h1&gt;
    &lt;p&gt;This is my first paragraph.&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
            </div>

            <h3>Understanding Each Part</h3>
            <table>
                <thead>
                    <tr>
                        <th>Tag</th>
                        <th>Purpose</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>&lt;!DOCTYPE html&gt;</code></td>
                        <td>Tells the browser this is an HTML5 document. Always put this at the very top.</td>
                    </tr>
                    <tr>
                        <td><code>&lt;html&gt;</code></td>
                        <td>The root element that contains all other HTML elements.</td>
                    </tr>
                    <tr>
                        <td><code>&lt;head&gt;</code></td>
                        <td>Contains information ABOUT the page (title, metadata). Not displayed on the page itself.</td>
                    </tr>
                    <tr>
                        <td><code>&lt;title&gt;</code></td>
                        <td>Sets the page title that appears in the browser tab.</td>
                    </tr>
                    <tr>
                        <td><code>&lt;body&gt;</code></td>
                        <td>Contains all the visible content of your webpage.</td>
                    </tr>
                </tbody>
            </table>

            <div class="warning-box">
                <strong>Important:</strong> Always close your tags in the reverse order you opened them. Think of it like Russian nesting dolls - the last one opened is the first one closed.
            </div>
        </div>

        <div class="content-section">
            <h2>Headings and Paragraphs</h2>

            <h3>Headings</h3>
            <p>HTML has six levels of headings, from <code>&lt;h1&gt;</code> (most important) to <code>&lt;h6&gt;</code> (least important). Just like in journalism, your main headline is the most important!</p>

            <div class="code-box">
                <div class="code-label">Heading Examples</div>
                <pre><code>&lt;h1&gt;Main Headline (Largest)&lt;/h1&gt;
&lt;h2&gt;Subheading&lt;/h2&gt;
&lt;h3&gt;Section Heading&lt;/h3&gt;
&lt;h4&gt;Smaller Heading&lt;/h4&gt;
&lt;h5&gt;Even Smaller&lt;/h5&gt;
&lt;h6&gt;Smallest Heading&lt;/h6&gt;</code></pre>
            </div>

            <div class="info-box">
                <strong>Best Practice:</strong> Use only ONE <code>&lt;h1&gt;</code> per page (your main headline). Use <code>&lt;h2&gt;</code> for major sections, <code>&lt;h3&gt;</code> for subsections, and so on.
            </div>

            <h3>Paragraphs</h3>
            <p>The <code>&lt;p&gt;</code> tag defines a paragraph. Browsers automatically add space before and after paragraphs.</p>

            <div class="code-box">
                <div class="code-label">Paragraph Example</div>
                <pre><code>&lt;p&gt;This is the first paragraph of my news article.&lt;/p&gt;
&lt;p&gt;This is the second paragraph with more information.&lt;/p&gt;
&lt;p&gt;Each paragraph is separated automatically by the browser.&lt;/p&gt;</code></pre>
            </div>
        </div>

        <div class="content-section">
            <h2>Creating Your First Webpage</h2>

            <div class="try-it">
                <h4>TRY IT YOURSELF - Step by Step</h4>

                <p><span class="step-number">1</span><strong>Open Your Text Editor</strong></p>
                <p style="margin-left: 40px;">Open Sublime Text or Notepad</p>

                <p style="margin-top: 15px;"><span class="step-number">2</span><strong>Type This Code Exactly</strong></p>
                <div class="code-box" style="margin-left: 40px;">
                    <pre><code>&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;My First News Page&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;Student Newspaper Launches Online Edition&lt;/h1&gt;
    &lt;h2&gt;New website aims to reach broader audience&lt;/h2&gt;

    &lt;p&gt;The campus newspaper announced today that it will launch
    an online edition next month.&lt;/p&gt;

    &lt;p&gt;Editor Sarah Johnson said the move will help the paper
    reach students who prefer digital news.&lt;/p&gt;

    &lt;h3&gt;What This Means for Students&lt;/h3&gt;
    &lt;p&gt;Students will be able to access news from their phones
    and tablets, making it easier to stay informed.&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
                </div>

                <p style="margin-top: 15px;"><span class="step-number">3</span><strong>Save Your File</strong></p>
                <ul style="margin-left: 40px;">
                    <li>Click File → Save As</li>
                    <li>Name it: <code>my-first-page.html</code></li>
                    <li>Make sure it ends with <strong>.html</strong></li>
                    <li>Save it to your Desktop or a folder you'll remember</li>
                </ul>

                <p style="margin-top: 15px;"><span class="step-number">4</span><strong>Open in Browser</strong></p>
                <ul style="margin-left: 40px;">
                    <li>Find the file you just saved</li>
                    <li>Double-click it (or right-click → Open With → Your Browser)</li>
                    <li>You should see your webpage!</li>
                </ul>

                <div class="success-box" style="margin-top: 15px;">
                    <strong>Congratulations!</strong> You just created your first webpage! Notice how the headings are different sizes and the paragraphs have spacing.
                </div>
            </div>
        </div>

        <div class="content-section">
            <h2>Common Beginner Mistakes</h2>

            <table>
                <thead>
                    <tr>
                        <th>Mistake</th>
                        <th>Problem</th>
                        <th>Solution</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Forgetting closing tags</td>
                        <td><code>&lt;p&gt;Text here</code></td>
                        <td>Always close: <code>&lt;p&gt;Text here&lt;/p&gt;</code></td>
                    </tr>
                    <tr>
                        <td>Misspelling tags</td>
                        <td><code>&lt;paragraf&gt;</code></td>
                        <td>Use correct spelling: <code>&lt;p&gt;</code></td>
                    </tr>
                    <tr>
                        <td>Not saving as .html</td>
                        <td>Saving as <code>page.txt</code></td>
                        <td>Must end with <code>.html</code></td>
                    </tr>
                    <tr>
                        <td>Mixing up opening/closing</td>
                        <td><code>&lt;/p&gt;Text&lt;p&gt;</code></td>
                        <td>Opening first: <code>&lt;p&gt;Text&lt;/p&gt;</code></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="content-section">
            <h2>Interactive Practice Exercise</h2>
            <div class="try-it">
                <h4>YOUR ASSIGNMENT</h4>
                <p>Create a new HTML page about a campus event (real or imaginary). Your page must include:</p>
                <ul>
                    <li>A main headline using <code>&lt;h1&gt;</code></li>
                    <li>A subheading using <code>&lt;h2&gt;</code></li>
                    <li>At least 3 paragraphs using <code>&lt;p&gt;</code></li>
                    <li>At least one section heading using <code>&lt;h3&gt;</code></li>
                    <li>Proper HTML structure (DOCTYPE, html, head, title, body)</li>
                </ul>

                <p style="margin-top: 15px;"><strong>Try it below:</strong> Your work is auto-saved!</p>

                <div class="info-box">
                    <strong>Tip:</strong> Write about something you know! Maybe a sports game, concert, club meeting, or guest speaker.
                </div>
                
                <!-- Interactive Code Editor -->
                <div style="margin-top: 20px; border: 2px solid #667eea; border-radius: 8px; overflow: hidden;">
                    <div style="background: #667eea; color: white; padding: 10px; display: flex; justify-content: space-between; align-items: center;">
                        <span><strong>💻 Code Editor</strong></span>
                        <div>
                            <button onclick="runCode()" style="background: #28a745; color: white; border: none; padding: 5px 15px; border-radius: 3px; cursor: pointer; margin-right: 10px;">▶ Run</button>
                            <button onclick="resetCode()" style="background: #dc3545; color: white; border: none; padding: 5px 15px; border-radius: 3px; cursor: pointer;">↻ Reset</button>
                        </div>
                    </div>
                    
                    <div style="display: flex; height: 400px;">
                        <!-- Code Editor -->
                        <div style="flex: 1; position: relative;">
                            <div id="monaco-editor" style="width: 100%; height: 100%;"></div>
                        </div>
                        
                        <!-- Preview -->
                        <div style="flex: 1; border-left: 2px solid #ddd; position: relative;">
                            <div style="background: #f5f5f5; padding: 8px; border-bottom: 1px solid #ddd; font-size: 14px; font-weight: bold;">Preview</div>
                            <iframe id="preview-frame" style="width: 100%; height: calc(100% - 40px); border: none; background: white;"></iframe>
                        </div>
                    </div>
                    
                    <div style="background: #f8f9fa; padding: 10px; border-top: 1px solid #ddd; font-size: 12px; color: #666;">
                        💾 Auto-saved | ✅ Your progress is tracked
                    </div>
                </div>
            </div>
        </div>

        <div class="content-section">
            <h2>Key Takeaways</h2>
            <ul>
                <li>HTML is the language that structures web content</li>
                <li>Tags come in pairs: opening <code>&lt;tag&gt;</code> and closing <code>&lt;/tag&gt;</code></li>
                <li>Every HTML page needs: DOCTYPE, html, head, title, and body</li>
                <li>Use headings <code>&lt;h1&gt;</code> to <code>&lt;h6&gt;</code> to organize content</li>
                <li>Use <code>&lt;p&gt;</code> tags for paragraphs</li>
                <li>Always save files with the <code>.html</code> extension</li>
            </ul>

            <div class="success-box">
                <strong>You Did It!</strong> You now understand the basics of HTML structure. In the next lesson, you'll learn how to format text and create links between pages.
            </div>
        </div>

        <div class="navigation">
            <a href="/dashboard.html" class="nav-button">← Back to Dashboard</a>
            <a href="lesson2.html" class="nav-button">Next: Text Formatting & Links →</a>
        </div>
    </div>

    <!-- Monaco Editor CDN -->
    <script src="https://cdn.jsdelivr.net/npm/monaco-editor@0.45.0/min/vs/loader.js"></script>

    <script>
        // Interactive Code Editor Functionality
        let editor;
        const previewFrame = document.getElementById('preview-frame');
        let autoSaveTimer;
        
        const initialCode = `<!DOCTYPE html>
<html>
<head>
    <title>Campus Event</title>
</head>
<body>
    <h1>Your Event Title Here</h1>
    
    <h2>Event Details</h2>
    <p>Write your first paragraph here...</p>
    
    <h3>What to Expect</h3>
    <p>Write your second paragraph here...</p>
    
    <p>Write your third paragraph here...</p>
    
</body>
</html>`;

        // Initialize Monaco Editor
        function initEditor() {
            require.config({ paths: { vs: 'https://cdn.jsdelivr.net/npm/monaco-editor@0.45.0/min/vs' } });
            require(['vs/editor/editor.main'], function () {
                editor = monaco.editor.create(document.getElementById('monaco-editor'), {
                    value: initialCode,
                    language: 'html',
                    theme: 'vs-dark',
                    automaticLayout: true,
                    fontSize: 14,
                    minimap: { enabled: true },
                    wordWrap: 'on',
                    lineNumbers: 'on',
                    scrollBeyondLastLine: false,
                    renderWhitespace: 'selection',
                    bracketPairColorization: { enabled: true },
                    formatOnPaste: true,
                    formatOnType: true
                });

                // Auto-update preview on content change
                editor.onDidChangeModelContent(() => {
                    updatePreview();
                    
                    // Clear existing timer
                    clearTimeout(autoSaveTimer);
                    
                    // Set new timer for auto-save
                    autoSaveTimer = setTimeout(() => {
                        autoSave();
                    }, 2000);
                });

                // Initial preview
                updatePreview();
                loadSavedCode();
            });
        }

        function updatePreview() {
            if (!editor) return;
            const code = editor.getValue();
            const blob = new Blob([code], { type: 'text/html' });
            previewFrame.src = URL.createObjectURL(blob);
        }

        function runCode() {
            updatePreview();
            // Add visual feedback
            const runBtn = document.querySelector('button[onclick="runCode()"]');
            const originalText = runBtn.innerHTML;
            runBtn.innerHTML = '✓ Updated';
            runBtn.style.background = '#28a745';
            
            setTimeout(() => {
                runBtn.innerHTML = originalText;
                runBtn.style.background = '#28a745';
            }, 1500);
        }

        function resetCode() {
            if (confirm('Are you sure you want to reset your code? This cannot be undone.')) {
                if (editor) {
                    editor.setValue(initialCode);
                    updatePreview();
                    autoSave();
                }
            }
        }

        function autoSave() {
            if (!editor) return;
            const code = editor.getValue();
            const lessonId = 1;
            
            // Save to localStorage for immediate persistence
            localStorage.setItem(`lesson_${lessonId}_code`, code);
            
            // Send to server if user is logged in
            fetch('/api/lessons/1/save', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ code })
            }).then(response => {
                if (response.ok) {
                    console.log('Code auto-saved to server');
                } else {
                    console.log('Code saved locally (not logged in)');
                }
            }).catch(err => {
                console.log('Code saved locally (offline)');
            });
        }

        function loadSavedCode() {
            const lessonId = 1;
            const savedCode = localStorage.getItem(`lesson_${lessonId}_code`);
            
            if (savedCode && savedCode.trim() !== initialCode.trim()) {
                if (confirm('We found some previously saved code. Would you like to restore it?')) {
                    if (editor) {
                        editor.setValue(savedCode);
                        updatePreview();
                    }
                }
            }
        }

        // Time tracking
        let startTime = Date.now();
        let timeSpent = 0;
        let timeTrackingInterval;

        function startTimeTracking() {
            timeTrackingInterval = setInterval(() => {
                timeSpent = Math.floor((Date.now() - startTime) / 1000);
                updateTimeSpentDisplay();
                
                // Send time update to server every 30 seconds
                if (timeSpent > 0 && timeSpent % 30 === 0) {
                    updateServerTime();
                }
            }, 1000);
        }

        function updateTimeSpentDisplay() {
            const minutes = Math.floor(timeSpent / 60);
            const seconds = timeSpent % 60;
            document.title = `Lesson 1: HTML Basics (${minutes}m ${seconds}s)`;
        }

        function updateServerTime() {
            fetch('/api/progress/time', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ lessonId: 1, seconds: 30 })
            }).catch(err => console.log('Time tracking offline'));
        }

        // Pause tracking when user leaves the page
        document.addEventListener('visibilitychange', () => {
            if (document.hidden) {
                clearInterval(timeTrackingInterval);
                updateServerTime(); // Save current progress
            } else {
                startTime = Date.now() - (timeSpent * 1000); // Resume from where we left off
                startTimeTracking();
            }
        });

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            initEditor();
            startTimeTracking();
        });
    </script>
</body>
</html>
